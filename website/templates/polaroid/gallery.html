{% extends "base.html" %}

{% load staticfiles %}

{% block extra_include %}
    <script src="{% static 'polaroid/js/lib/nanobar.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'polaroid/js/src/alert.js' %}" type="text/javascript"></script>
    <script src="{% static 'polaroid/js/src/cover.js' %}" type="text/javascript"></script>
    <script src="{% static 'polaroid/js/src/name.js' %}" type="text/javascript"></script>
    <script src="{% static 'polaroid/js/src/gallery.js' %}" type="text/javascript"></script>
{% endblock %}

{% block bodyclass %}gallery{% endblock %}

{% block hdr-right %}
    {% if gal.owner == user %}
        <a href="#" id="pin"><span class="glyphicon glyphicon-pushpin"></span></a>
        <a href="#" id="remove"><span class="glyphicon glyphicon-trash"></span></a>
    {% endif %}
        <a href="#" id="like"><span class="glyphicon glyphicon-heart"></span></a>
{% endblock %}

{% block content %}

<input type="hidden" id="gid" value="{{ gal.id }}">
<div id="gallery" class="rm-container">
    {% for img in imgs %}
        <a href="/img/{{ gal.id }}/{{ img.id }}.jpg" class="img">
            <img src="/img/{{ gal.id }}/{{ img.id }}-small.jpg" alt="void" data-id="{{ img.id }}" />
        </a>
    {% endfor %}
    <div id="padding"></div>
</div>

<div id="alert"><div class="alert-txt"></div></div>
{% endblock %}

{% block extra_script %}
    var nanobar = new Nanobar({
        bg: "#FFFFFF",
    });
    var dpz = new Dropzone(document.body, {
        paramName: "path", 
        clickable: false,
        previewsContainer: "",
        method: "post",
        url: "{% url 'upload' %}",
    });
    dpz.on("sending", function(file, xhr, formData) {
        formData.append("gl", "{{ gal.id }}");
        formData.append("csrfmiddlewaretoken", "{{ csrf_token }}");
    });
    dpz.on("uploadprogress", function(file) {
        nanobar.go(file.upload.progress);
    });
    dpz.on("success", function(file, xhr) {
        //location.reload();
    });
{% endblock %}
